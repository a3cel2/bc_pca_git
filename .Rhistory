saved_parameter_path <- '../data/script_input'
heatmap_cluster_file <- 'cluster1_heatmap.tsv'
figure_path <- '../results/rmarkdown_figures'
error_analysis <- pca_mRNA_error_analysis(pca_universe,expression_file,protein_abundance_file,iters=10)
head(error_analysis)
cor(error_analysis)
cor(error_analysis,use='pair')
error_analysis <- pca_mRNA_error_analysis(pca_universe,expression_file,protein_abundance_file,iters=10)
library(devtools)
library(Cairo)
library(dplyr)
library(grDevices)
library(xlsx)
library(rmarkdown)
this.dir <- dirname(parent.frame(2)$ofile)
setwd(this.dir)
#Parts of analysis to run
#Options:
#Atorvastatin enrichment
#GO enrichment
to_run <- c('Expression PCA')#'Expression PCA')#c('Frequency Perturbation')#c('Atorvastatin enrichment')
#Markdown directory
#Package containing necessary scripts
devtools::load_all('../packages/bcPcaAnalysis')
devtools::document('../packages/bcPcaAnalysis')
#Global parameters
pca_universe = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.6.txt'
pca_enhanced_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.10.txt'
pca_depleted_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.11.txt'
go_association_file = '/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/funcassociate_go_associations.txt'
protein_abundance_file = "/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/paxdb_abundance.tsv"
expression_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.14.txt'
hub_enrichment_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-09-02/Data for Figure 3D.xlsx'
output_path <- '../results/master_output'
saved_parameter_path <- '../data/script_input'
heatmap_cluster_file <- 'cluster1_heatmap.tsv'
figure_path <- '../results/rmarkdown_figures'
error_analysis <- pca_mRNA_error_analysis(pca_universe,expression_file,protein_abundance_file,iters=10)
cor(error_analysis,use='pair')
library(devtools)
library(Cairo)
library(dplyr)
library(grDevices)
library(xlsx)
library(rmarkdown)
this.dir <- dirname(parent.frame(2)$ofile)
setwd(this.dir)
#Parts of analysis to run
#Options:
#Atorvastatin enrichment
#GO enrichment
to_run <- c('Expression PCA')#'Expression PCA')#c('Frequency Perturbation')#c('Atorvastatin enrichment')
#Markdown directory
#Package containing necessary scripts
devtools::load_all('../packages/bcPcaAnalysis')
devtools::document('../packages/bcPcaAnalysis')
#Global parameters
pca_universe = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.6.txt'
pca_enhanced_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.10.txt'
pca_depleted_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.11.txt'
go_association_file = '/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/funcassociate_go_associations.txt'
protein_abundance_file = "/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/paxdb_abundance.tsv"
expression_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.14.txt'
hub_enrichment_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-09-02/Data for Figure 3D.xlsx'
output_path <- '../results/master_output'
saved_parameter_path <- '../data/script_input'
heatmap_cluster_file <- 'cluster1_heatmap.tsv'
figure_path <- '../results/rmarkdown_figures'
error_analysis <- pca_mRNA_error_analysis(pca_universe,expression_file,protein_abundance_file,iters=10)
cor(error_analysis,use='pair')
library(devtools)
library(Cairo)
library(dplyr)
library(grDevices)
library(xlsx)
library(rmarkdown)
this.dir <- dirname(parent.frame(2)$ofile)
setwd(this.dir)
#Parts of analysis to run
#Options:
#Atorvastatin enrichment
#GO enrichment
to_run <- c('Expression PCA')#'Expression PCA')#c('Frequency Perturbation')#c('Atorvastatin enrichment')
#Markdown directory
#Package containing necessary scripts
devtools::load_all('../packages/bcPcaAnalysis')
devtools::document('../packages/bcPcaAnalysis')
#Global parameters
pca_universe = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.6.txt'
pca_enhanced_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.10.txt'
pca_depleted_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.11.txt'
go_association_file = '/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/funcassociate_go_associations.txt'
protein_abundance_file = "/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/paxdb_abundance.tsv"
expression_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.14.txt'
hub_enrichment_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-09-02/Data for Figure 3D.xlsx'
output_path <- '../results/master_output'
saved_parameter_path <- '../data/script_input'
heatmap_cluster_file <- 'cluster1_heatmap.tsv'
figure_path <- '../results/rmarkdown_figures'
error_analysis <- pca_mRNA_error_analysis(pca_universe,expression_file,protein_abundance_file,iters=10)
library(devtools)
library(Cairo)
library(dplyr)
library(grDevices)
library(xlsx)
library(rmarkdown)
this.dir <- dirname(parent.frame(2)$ofile)
setwd(this.dir)
#Parts of analysis to run
#Options:
#Atorvastatin enrichment
#GO enrichment
to_run <- c('Expression PCA')#'Expression PCA')#c('Frequency Perturbation')#c('Atorvastatin enrichment')
#Markdown directory
#Package containing necessary scripts
devtools::load_all('../packages/bcPcaAnalysis')
devtools::document('../packages/bcPcaAnalysis')
#Global parameters
pca_universe = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.6.txt'
pca_enhanced_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.10.txt'
pca_depleted_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.11.txt'
go_association_file = '/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/funcassociate_go_associations.txt'
protein_abundance_file = "/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/paxdb_abundance.tsv"
expression_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.14.txt'
hub_enrichment_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-09-02/Data for Figure 3D.xlsx'
output_path <- '../results/master_output'
saved_parameter_path <- '../data/script_input'
heatmap_cluster_file <- 'cluster1_heatmap.tsv'
figure_path <- '../results/rmarkdown_figures'
error_analysis <- pca_mRNA_error_analysis(pca_universe,expression_file,protein_abundance_file,iters=10)
cor(error_analysis,use='pair')
library(devtools)
library(Cairo)
library(dplyr)
library(grDevices)
library(xlsx)
library(rmarkdown)
this.dir <- dirname(parent.frame(2)$ofile)
setwd(this.dir)
#Parts of analysis to run
#Options:
#Atorvastatin enrichment
#GO enrichment
to_run <- c('Expression PCA')#'Expression PCA')#c('Frequency Perturbation')#c('Atorvastatin enrichment')
#Markdown directory
#Package containing necessary scripts
devtools::load_all('../packages/bcPcaAnalysis')
devtools::document('../packages/bcPcaAnalysis')
#Global parameters
pca_universe = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.6.txt'
pca_enhanced_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.10.txt'
pca_depleted_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.11.txt'
go_association_file = '/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/funcassociate_go_associations.txt'
protein_abundance_file = "/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/paxdb_abundance.tsv"
expression_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.14.txt'
hub_enrichment_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-09-02/Data for Figure 3D.xlsx'
output_path <- '../results/master_output'
saved_parameter_path <- '../data/script_input'
heatmap_cluster_file <- 'cluster1_heatmap.tsv'
figure_path <- '../results/rmarkdown_figures'
error_analysis <- pca_mRNA_error_analysis(pca_universe,expression_file,protein_abundance_file,iters=10)
cor(error_analysis,use='pair')
diag(error_analysis,use='pair')
upper.tri(error_analysis)
error_cor <- cor(error_analysis)
error_cor[upper.tri(error_cor)]
error_cor
error_cor <- cor(error_analysis,use='pair')
error_cor[upper.tri(error_cor)]
mean(error_cor[upper.tri(error_cor)])
1/0.6^2
1/(0.6^2)
1/(0.44^1) - 1/(0.6^2)
1/(0.44^1) - 1/(0.6^2) + 1
1/(1/(0.44^1) - 1/(0.6^2) + 1)
1/(1/(0.44^2) - 1/(0.6^2) + 1)
0.44^2
1/(1/(0.44^2) - 1/(0.5^2) + 1)
1/(1/(0.44^2) - 1/(0.45^2) + 1)
1/(1/(0.6^2) - 1/(0.7^2) + 1)
1/(1/(0.56^2) - 1/(0.7^2) + 1)
error_analysis <- pca_mRNA_error_analysis(pca_universe,expression_file,protein_abundance_file,iters=10,q_val_cutoff=0.05)
error_analysis <- pca_mRNA_error_analysis(pca_universe,expression_file,protein_abundance_file,iters=10,q_val_cutoff=0.05,fc_cutoff=0.25)
error_cor <- cor(error_analysis,use='pair')
mean(error_cor[upper.tri(error_cor)])
1/(1/(0.56^2) - 1/(0.66^2) + 1)
source('~/Dropbox/Roth Lab/projects/bc_pca_git/scripts/master.R', echo=TRUE)
library(devtools)
library(Cairo)
library(dplyr)
library(grDevices)
library(xlsx)
library(rmarkdown)
this.dir <- dirname(parent.frame(2)$ofile)
setwd(this.dir)
#Parts of analysis to run
#Options:
#Atorvastatin enrichment
#GO enrichment
to_run <- c('Expression PCA')#'Expression PCA')#c('Frequency Perturbation')#c('Atorvastatin enrichment')
#Markdown directory
#Package containing necessary scripts
devtools::load_all('../packages/bcPcaAnalysis')
devtools::document('../packages/bcPcaAnalysis')
#Global parameters
pca_universe = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.6.txt'
pca_enhanced_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.10.txt'
pca_depleted_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.11.txt'
go_association_file = '/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/funcassociate_go_associations.txt'
protein_abundance_file = "/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/paxdb_abundance.tsv"
expression_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.14.txt'
hub_enrichment_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-09-02/Data for Figure 3D.xlsx'
output_path <- '../results/master_output'
saved_parameter_path <- '../data/script_input'
heatmap_cluster_file <- 'cluster1_heatmap.tsv'
figure_path <- '../results/rmarkdown_figures'
library(devtools)
library(Cairo)
library(dplyr)
library(grDevices)
library(xlsx)
library(rmarkdown)
this.dir <- dirname(parent.frame(2)$ofile)
setwd(this.dir)
#Parts of analysis to run
#Options:
#Atorvastatin enrichment
#GO enrichment
to_run <- c('Expression PCA')#'Expression PCA')#c('Frequency Perturbation')#c('Atorvastatin enrichment')
#Markdown directory
#Package containing necessary scripts
devtools::load_all('../packages/bcPcaAnalysis')
devtools::document('../packages/bcPcaAnalysis')
#Global parameters
pca_universe = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.6.txt'
pca_enhanced_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.10.txt'
pca_depleted_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.11.txt'
go_association_file = '/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/funcassociate_go_associations.txt'
protein_abundance_file = "/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/paxdb_abundance.tsv"
expression_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.14.txt'
hub_enrichment_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-09-02/Data for Figure 3D.xlsx'
output_path <- '../results/master_output'
saved_parameter_path <- '../data/script_input'
heatmap_cluster_file <- 'cluster1_heatmap.tsv'
figure_path <- '../results/rmarkdown_figures'
error_analysis <- pca_mRNA_error_analysis(pca_universe,expression_file,protein_abundance_file,iters=10,q_val_cutoff=0.05,fc_cutoff=0.25)
cor(error_analysis,use='pair')
1/(1/(0.56^2) - 1/(0.77^2) + 1)
1/(1/(0.56^2) - 1/(0.8^2) + 1)
expr_matr <- mRNA_comparison(pca_file,expression_file,condition,expression_condition_regexp_vec,expression_control_regexp_vec)
pca_file <- pca_universe
expression_condition_regexp_vec=c('Ethanol.4h','Ethanol.12h')
expression_control_regexp_vec=c('Ethanol.0h','Ethanol.0h')
expr_matr <- mRNA_comparison(pca_file,expression_file,condition,expression_condition_regexp_vec,expression_control_regexp_vec)
condition='ethanol'
expr_matr <- mRNA_comparison(pca_file,expression_file,condition,expression_condition_regexp_vec,expression_control_regexp_vec)
head(expr_matr)
pca_file <- read.csv(pca_file,head = T,stringsAsFactors = F, sep = '\t')
merged_pca_calls <- merge_pca_file(pca_file,condition=condition)
merged_pca_calls <- dplyr::filter(merged_pca_calls,q.val <= q_val_cutoff, abs(FC.avg) >= fc_cutoff)
q_val_cutoff <- 0.05
fc_cutoff <- 0.25
pca_file <- read.csv(pca_file,head = T,stringsAsFactors = F, sep = '\t')
merged_pca_calls <- merge_pca_file(pca_file,condition=condition)
merged_pca_calls <- dplyr::filter(merged_pca_calls,q.val <= q_val_cutoff, abs(FC.avg) >= fc_cutoff)
head(pca_file)
head(merged_pca_calls)
head(c(merged_pca_calls$ORF.1,merged_pca_calls$ORF.2))
c(merged_pca_calls$ORF.1,merged_pca_calls$ORF.2)
c(as.vector(merged_pca_calls$ORF.1),as.vector(merged_pca_calls$ORF.2))
unique(c(as.vector(merged_pca_calls$ORF.1),as.vector(merged_pca_calls$ORF.2)))
used_orfs <- unique(c(as.vector(merged_pca_calls$ORF.1),as.vector(merged_pca_calls$ORF.2)))
head(expr_matr)
expr_matr[used_orfs,]
library(devtools)
library(Cairo)
library(dplyr)
library(grDevices)
library(xlsx)
library(rmarkdown)
this.dir <- dirname(parent.frame(2)$ofile)
setwd(this.dir)
#Parts of analysis to run
#Options:
#Atorvastatin enrichment
#GO enrichment
to_run <- c('Expression PCA')#'Expression PCA')#c('Frequency Perturbation')#c('Atorvastatin enrichment')
#Markdown directory
#Package containing necessary scripts
devtools::load_all('../packages/bcPcaAnalysis')
devtools::document('../packages/bcPcaAnalysis')
#Global parameters
pca_universe = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.6.txt'
pca_enhanced_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.10.txt'
pca_depleted_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.11.txt'
go_association_file = '/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/funcassociate_go_associations.txt'
protein_abundance_file = "/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/paxdb_abundance.tsv"
expression_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.14.txt'
hub_enrichment_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-09-02/Data for Figure 3D.xlsx'
output_path <- '../results/master_output'
saved_parameter_path <- '../data/script_input'
heatmap_cluster_file <- 'cluster1_heatmap.tsv'
figure_path <- '../results/rmarkdown_figures'
error_analysis <- pca_mRNA_error_analysis(pca_universe,expression_file,protein_abundance_file,iters=10,q_val_cutoff=0.05,fc_cutoff=0.25)
cor(error_analysis,use='pair')
error_cor <- cor(error_analysis,use='pair')
error_cor[upper.tri(error_cor)]
mean(error_cor[upper.tri(error_cor)])
1/(0.55^2)
1/(0.666^2)
1/(0.44^2)-1/(0.666^2)
1/(0.44^2)-1/(0.666^2)+1
1/(1/(0.44^2)-1/(0.666^2)+1)
1/(1/(0.53^2)-1/(0.666^2)+1)
1/(1/(0.56^2)-1/(0.666^2)+1)
1/(1/(0.53^2)-1/(0.666^2)+1)
0.53^2
filtered_predictions <- filter(my_predictions,
bcPCA_qVal < 0.05,
abs(bcPCA_FC.AVG) > 0.25)
my_predictions <- pca_ma_prediction(pca_universe,
protein_abundance_file,
expression_file,
'ethanol',
expression_condition_regexp='Ethanol.4h')
filtered_predictions <- filter(my_predictions,
bcPCA_qVal < 0.05,
abs(bcPCA_FC.AVG) > 0.25)
head(filtered_predictions)
cor(filtered_predictions$bcPCA_FC.AVG,filtered_predictions$Log2_MA_prediction)
cor(filtered_predictions$bcPCA_FC.AVG,filtered_predictions$Log2_MA_prediction,use='pair')
cor.test(filtered_predictions$bcPCA_FC.AVG,filtered_predictions$Log2_MA_prediction,use='pair')
1/(1/(0.58^2)-1/(0.666^2)+1)
1/(1/(0.47^2)-1/(0.666^2)+1)
head(my_predictions)
head(pca_universe)
head(read.table('pca_universe'))
head(read.table(pca_universe))
head(read.table(pca_universe,head=T))
derp <- read.table(pca_universe,head=T)
derp <- dplyr::filter(derp,Condition='ethanol')
derp <- dplyr::filter(derp,Condition=='ethanol')
head(derp)
cor(derp$FC.rep1)
cor(derp$FC.rep1,derp$FC.rep2)
plot(derp$FC.rep1,derp$FC.rep2)
derp_uptag <- filter(derp,UP.DN='uptag')
derp_uptag <- filter(derp,UP.DN=='uptag')
derp_dntag <- filter(derp,UP.DN=='downtag')
head(derp_uptag)
dim(derp_uptag)
dim(derp_dntag)
cor(derp_uptag$FC.avg,derp_dntag$FC.avg)
plot(derp_uptag$FC.avg,derp_dntag$FC.avg)
abline(c(0,1),col='red',lwd=2)
abline(c(1,1),col='red',lwd=2)
abline(c(-1,1),col='red',lwd=2)
filtered_predictions <- filter(my_predictions,
abs(bcPCA_FC.UP - bcPCA_FC.DN) <= 1,
bcPCA_qVal < 0.05,
abs(bcPCA_FC.AVG) > 0.25)
pca_ma_prediction_plot(filtered_predictions,
expression_pca_output_path,
filename='bcPCA_predictions_significant_filtered.pdf')
pca_mRNA_error_analysis()
help(pca_mRNA_error_analysis)
warnings9)
warnings()
cor(derp_uptag$FC.avg,derp_dntag$FC.avg)
cor(derp_uptag$FC.rep1,derp_dntag$FC.rep1)
cor(derp_uptag$FC.rep2,derp_dntag$FC.rep2)
cor(derp_uptag$FC.rep1,derp_dntag$FC.rep2)
head(merged_pca_calls)
pca_file <- read.csv(pca_file,head = T,stringsAsFactors = F, sep = '\t')
merged_pca_calls <- merge_pca_file(pca_file,condition=condition)
merged_pca_calls <- dplyr::filter(merged_pca_calls,q.val <= q_val_cutoff, abs(FC.avg) >= fc_cutoff)
pca_file <- pca_universe
pca_file <- read.csv(pca_file,head = T,stringsAsFactors = F, sep = '\t')
merged_pca_calls <- merge_pca_file(pca_file,condition=condition)
merged_pca_calls <- dplyr::filter(merged_pca_calls,q.val <= q_val_cutoff, abs(FC.avg) >= fc_cutoff)
condition='ethanol'
pca_file <- read.csv(pca_file,head = T,stringsAsFactors = F, sep = '\t')
merged_pca_calls <- merge_pca_file(pca_file,condition=condition)
merged_pca_calls <- dplyr::filter(merged_pca_calls,q.val <= q_val_cutoff, abs(FC.avg) >= fc_cutoff)
q_val_cutoff=1
fc_cutoff=0
pca_file <- read.csv(pca_file,head = T,stringsAsFactors = F, sep = '\t')
merged_pca_calls <- merge_pca_file(pca_file,condition=condition)
merged_pca_calls <- dplyr::filter(merged_pca_calls,q.val <= q_val_cutoff, abs(FC.avg) >= fc_cutoff)
head(merged_pca_file)
head(merged_pca_cals)
head(merged_pca_calls)
pca_file <- pca_universe
pca_file <- read.csv(pca_file,head = T,stringsAsFactors = F, sep = '\t')
merged_pca_calls <- merge_pca_file(pca_file,condition=condition)
merged_pca_calls <- dplyr::filter(merged_pca_calls,q.val <= q_val_cutoff,
abs(FC.avg) >= fc_cutoff,
abs(FC.UP - FC.DN) <= up_dn_diff_cutoff)
up_dn_diff_cutoff=Inf
pca_file <- read.csv(pca_file,head = T,stringsAsFactors = F, sep = '\t')
merged_pca_calls <- merge_pca_file(pca_file,condition=condition)
merged_pca_calls <- dplyr::filter(merged_pca_calls,q.val <= q_val_cutoff,
abs(FC.avg) >= fc_cutoff,
abs(FC.UP - FC.DN) <= up_dn_diff_cutoff)
up_dn_diff_cutoff = 1
pca_file <- pca_universe
pca_file <- read.csv(pca_file,head = T,stringsAsFactors = F, sep = '\t')
merged_pca_calls <- merge_pca_file(pca_file,condition=condition)
merged_pca_calls <- dplyr::filter(merged_pca_calls,q.val <= q_val_cutoff,
abs(FC.avg) >= fc_cutoff,
abs(FC.UP - FC.DN) <= up_dn_diff_cutoff)
library(devtools)
library(Cairo)
library(dplyr)
library(grDevices)
library(xlsx)
library(rmarkdown)
this.dir <- dirname(parent.frame(2)$ofile)
setwd(this.dir)
#Parts of analysis to run
#Options:
#Atorvastatin enrichment
#GO enrichment
to_run <- c('Expression PCA')#'Expression PCA')#c('Frequency Perturbation')#c('Atorvastatin enrichment')
#Markdown directory
#Package containing necessary scripts
devtools::load_all('../packages/bcPcaAnalysis')
devtools::document('../packages/bcPcaAnalysis')
#Global parameters
pca_universe = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.6.txt'
pca_enhanced_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.10.txt'
pca_depleted_calls = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.11.txt'
go_association_file = '/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/funcassociate_go_associations.txt'
protein_abundance_file = "/Users/Albi/Dropbox/Roth Lab/projects/bc_pca_git/data/paxdb_abundance.tsv"
expression_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-08-30/Additional.file.14.txt'
hub_enrichment_file = '/Users/Albi/Dropbox/barcoded-PCA/2015-09-02/Data for Figure 3D.xlsx'
output_path <- '../results/master_output'
saved_parameter_path <- '../data/script_input'
heatmap_cluster_file <- 'cluster1_heatmap.tsv'
figure_path <- '../results/rmarkdown_figures'
#Color scale for a lot of stuff
my_color_list <- c(
rgb(1,0.45,0.25),
rgb(0.8,0.25,0.25),
rgb(0,0,0),
rgb(0.25,0.45,0.8),
rgb(0.25,0.75,1)
)
blue_black_orange <- grDevices::colorRampPalette(my_color_list)
error_analysis <- pca_mRNA_error_analysis(pca_universe,expression_file,protein_abundance_file,iters=100)
head(pca_mRNA_error_analysis())
head(pca_mRNA_error_analysis)
error_analysis <- pca_mRNA_error_analysis(pca_universe,expression_file,protein_abundance_file,iters=100,q_val_cutoff=0.05,fc_cutoff=0.25,up_dn_diff_cutoff=1)
all_pairs <- cor(error_analysis,use='pair')
all_pairs[upper.tri(all_pairs)]
mean(all_pairs[upper.tri(all_pairs)])
1/(1/(0.56^2))
1/(0.56^2)
1/(0.56^2)+1/(0.66^2)
1/(0.56^2)+1/(0.66^2)+1
1/(0.56^2)-1/(0.66^2)+1
1/(1/(0.56^2)-1/(0.66^2)+1)
filtered_predictions <- filter(my_predictions,
abs(bcPCA_FC.UP - bcPCA_FC.DN) <= 1,
bcPCA_qVal < 0.05,
abs(bcPCA_FC.AVG) > 0.25)
my_predictions <- pca_ma_prediction(pca_universe,
protein_abundance_file,
expression_file,
'ethanol',
expression_condition_regexp='Ethanol.4h')
filtered_predictions <- filter(my_predictions,
abs(bcPCA_FC.UP - bcPCA_FC.DN) <= 1,
bcPCA_qVal < 0.05,
abs(bcPCA_FC.AVG) > 0.25)
head(filtered_predictions)
cor(filtered_predictions$bcPCA_FC.AVG,filtered_predictions$Log2_MA_prediction)
cor(filtered_predictions$bcPCA_FC.AVG,filtered_predictions$Log2_MA_prediction,use='pair')
cor.test(filtered_predictions$bcPCA_FC.AVG,filtered_predictions$Log2_MA_prediction,use='pair')
1/(1/(0.497^2)-1/(0.66^2)+1)
1/(1/(0.608^2)-1/(0.66^2)+1)
1/(1/(0.555^2)-1/(0.66^2)+1)
0.56^2
source('~/Dropbox/Roth Lab/projects/bc_pca_git/scripts/master.R', echo=TRUE)
e1 <- rnorm(100,sd=1)
e2 <- rnorm(100,sd=2.3)
e1 <- rnorm(10000,sd=1)
e2 <- rnorm(10000,sd=2.3)
x <- rnorm(10000,sd=1)
cor(x,e1)
cor(x,x+e1)
cor(x,x+e2)
1/cor(x,x+e1)^2
1/cor(x,x+e1)^2 - 1/cor(x,x+e1+e2)^2
(1/cor(x,x+e1+e2)^2) - 1/cor(x,x+e1)^2
(1/cor(x,x+e1+e2)^2) - 1/cor(x,x+e1)^2 + 1
1/((1/cor(x,x+e1+e2)^2) - 1/cor(x,x+e1)^2 + 1)
cor(x,x+e2)
1/((1/cor(x,x+e1+e2)^2) - 1/cor(x,x+e1)^2)
1/cor(x,x+e1+e2)^2
1/cor(x,x+e1+e2)
cor(x,x+e1+e2)
cor(x,x+e1+e2)^2
cor(x,x+e1+e2)^-2
cor(x,x+e1)^-2
cor(x,x+e1+e2)^-2 - cor(x,x+e2)^-2
cor(x,x+e1+e2)^-2 - cor(x,x+e2)^-2 + 1
1/(cor(x,x+e1+e2)^-2 - cor(x,x+e2)^-2 + 1)
cor(x,x+e1)
cor(x,x+e1)^2
1/(cor(x,x+e1+e2)^-2 - cor(x,x+e1)^-2 + 1)
cor(x,x+e2)^2
