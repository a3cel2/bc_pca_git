needed_outcome <- 2^needed_outcome
Kd_vec <- c()
for(i in 1:nrow(predictions)){
Kd <- ((needed_outcome[i] - predictions[i,'PaxDB_Abundance_ORF1'])*(needed_outcome[i] - predictions[i,'PaxDB_Abundance_ORF2']))/needed_outcome[i]
Kd <- max(0.01,Kd)
Kd_vec <- rbind(Kd_vec,c(Kd,max(predictions[i,c('PaxDB_Abundance_ORF1','PaxDB_Abundance_ORF2')])/20))
}
new_preds <- c()
for(i in 1:nrow(predictions)){
new_prediction <- mass_action_predictor(predictions[i,c('PaxDB_Abundance_ORF1')],
predictions[i,c('PaxDB_Abundance_ORF2')],
predictions[i,c('mRNAFC_ORF1')],
predictions[i,c('mRNAFC_ORF2')])
#Kd_vec[i,1])
new_preds <- c(new_preds, log2(new_prediction))#*top_lm$coefficients[2] + top_lm$coefficients[1])
}
head(predictions)
plot(new_preds,predictions$Log2_MA_prediction)
cor(new_preds,predictions$Log2_MA_prediction)
cor(new_preds,predictions$Log2_MA_prediction,use='pair')
cor(new_preds,predictions$bcPCA_FC.AVG)
cor(new_preds,predictions$bcPCA_FC.AVG,use='pair')
head(new_preds)
head(Kd_vec)
plot(Kd_vec)
plot(log2(Kd_vec))
head(predictions)
head(Kd_vec)
155/20
156/20
616/20
abline(c(0,1))
head(predictions)
cor(predictions$Log2_MA_prediction,predictions$bcPCA_FC.AVG)
cor(predictions$Log2_MA_prediction,predictions$bcPCA_FC.AVG)
cor(new_preds,predictions$bcPCA_FC.AVG)
cor(new_preds,predictions$bcPCA_FC.AVG,use='pair')
1/mean(c(1/2,1/3)
)
1/mean(c(1/2,1/3))
1/mean(c(1/2,1/3,1/4))
1/mean(c(1/2,1/3,1/4,1/10))
mean(c(2,3,4,10))
1/mean(c(1/2,1/3,1/4,1/10,1/100))
mean(c(2,3,4,10,100))
1/mean(c(1/2,1/3,1/4,1/10,1/100,1/10000))
mean(c(2,3,4,10,100,10000))
head(pca_univ)
pca_univ <- read.table(pca_universe,head=T,sep='\t')
colnames(pca_univ)
unique <- pca_univ[,c('ORF.1','ORF.2')]
unique(pca_univ[,c('ORF.1','ORF.2')])
ppis <- unique(pca_univ[,c('ORF.1','ORF.2')])
as.vector(ppis)
head(ppis)
orfs <- unique(c(ppis[,1],ppis[,2]))
head(orfs)
orfs
pca_univ <- read.table(pca_universe,head=T,sep='\t',stringsAsFactors = F)
orfs <- unique(c(ppis[,1],ppis[,2]))
ppis <- unique(pca_univ[,c('ORF.1','ORF.2')])
orfs <- unique(c(ppis[,1],ppis[,2]))
head(orfs)
length(orfs)
levy_filename <- '../data/levy_2014_ab.tsv'
levy_data <- read.table(levy_filename,sep='\t',head=T)
head(levy_data)
cor(levy_data$GROWTH.CYTO,levy_data$AB.MS.hap)
cor(levy_data$GROWTH.CYTO,levy_data$AB.MS.hap,use='pair')
cor(levy_data$GROWTH.CYTO,levy_data$AB.MS.dipp,use='pair')
cor(levy_data$GROWTH.CYTO,levy_data$AB.MS.dip,use='pair')
cor(levy_data$GROWTH.CYTO,levy_data$AB.PAX.NORM,use='pair')
cor(levy_data$GROWTH.CYTO,levy_data$AB.PAX.NORM,use='pair',method='spear')
cor(levy_data$GROWTH.CYTO,levy_data$AB.MS.hap,use='pair',method='spear')
head(levy_data)
sub_levy_data <- levy_data[levy_data$ORF %in% orfs,]
cor(sub_levy_data$GROWTH.CYTO,sub_levy_data$AB.MS.hap,use='pair',method='spear')
cor(sub_levy_data$GROWTH.CYTO,sub_levy_data$AB.MS.hap,use='pair')
cor(sub_levy_data$GROWTH.CYTO,sub_levy_data$AB.MS.hap,use='pair',method='spear')
plot(sub_levy_data$GROWTH.CYTO,sub_levy_data$AB.MS.hap)#,use='pair',method='spear')
plot(sub_levy_data$GROWTH.CYTO,log(sub_levy_data$AB.MS.hap))#,use='pair',method='spear')
plot(sub_levy_data$GROWTH.CYTO,log(sub_levy_data$AB.GFP.YMD))#,use='pair',method='spear')
cor(sub_levy_data$GROWTH.CYTO,sub_levy_data$AB.MS.hap,use='pair',method='spear')
cor(sub_levy_data$GROWTH.CYTO,sub_levy_data$AB.GFP.YMD,use='pair',method='spear')
cor(sub_levy_data$GROWTH.CYTO,sub_levy_data$AB.GFP.YMD,use='pair')
cor(sub_levy_data$GROWTH.CYTO,sub_levy_data$AB.GFP.YMD,use='pair',method='spear')
cor(levy_data$GROWTH.CYTO,levy_data$AB.GFP.YMD,use='pair',method='spear')
cor(levy_data$GROWTH.CYTO,levy_data$AB.GFP.YPD,use='pair',method='spear')
cor(levy_data$GROWTH.CYTO,levy_data$AB.WESTEN,use='pair',method='spear')
cor(sub_levy_data$GROWTH.CYTO,sub_levy_data$AB.WESTEN,use='pair',method='spear')
source('~/Dropbox/Roth Lab/projects/bc_pca_git/scripts/master.R', echo=TRUE)
#mRNA Levy Comparison
levy_filename <- '../data/levy_2014_ab.tsv'
mRNA_filename <- expression_file
levy_output_path <- paste(c(output_path,'levy_comparison'),collapse='/')
dir.create(levy_output_path, showWarnings = FALSE)
outfile <- paste(c(levy_output_path,'mRNA_0h_vs_levy_abundance.pdf'),collapse='/')
CairoPDF(file=outfile,width=9,height=5)
mRNA_levy_comparison(levy_filename,mRNA_filename)
dev.off()
pwd
getwd()
setwd('../../twas_git/')
setwd('data/scratch/')
ls
list.files()
nzm_original <- read.table('pick.SOURCE_PLAT_INFO.genotype_sBARCODE10042013-2.tsv')
nzm_original <- read.table('pick.SOURCE_PLAT_INFO.genotype_sBARCODE10042013-2.tsv',sep='\t')
head(nzm_original)
head(nzm_original)
head(nzm_original$V18)
head(nzm_original$V8)
nzm_original <- read.table('pick.SOURCE_PLAT_INFO.genotype_sBARCODE10042013-2.tsv',sep='\t',stringsAsFactors = F)
?raed.table
?read.table
nzm_original <- read.table('pick.SOURCE_PLAT_INFO.genotype_sBARCODE10042013-2.tsv',sep='\t',stringsAsFactors = F,skip=1)
head(nzm_original)
nzm_original <- read.table('pick.SOURCE_PLAT_INFO.genotype_sBARCODE10042013-2.tsv',sep='\t',stringsAsFactors = F,skip=2)
head(nzm_original)
nzm_original <- read.table('pick.SOURCE_PLAT_INFO.genotype_sBARCODE10042013-2.tsv',sep='\t',stringsAsFactors = F,skip=2,head=T)
head(nzm_original)
sum(nzm_original$UPTAG == 'Unique UPTAG')
sum(nzm_original$UPTAG.stat == 'Unique UPTAG')
sum(nzm_original$UPTAG.stat == 'Unique UPTAG' | nzm_original$UPTAG.stat == 'Unique UPTAG')
sum(nzm_original$UPTAG.stat == 'Unique UPTAG' | nzm_original$UPTAG.stat == 'Unique DNTAG')
sum(nzm_original$UPTAG.stat == 'Unique UPTAG' | nzm_original$DNTAG.stat == 'Unique DNTAG')
nzo_original[nzm_original$UPTAG.stat == 'Unique UPTAG' | nzm_original$DNTAG.stat == 'Unique DNTAG',]
nzm_original[nzm_original$UPTAG.stat == 'Unique UPTAG' | nzm_original$DNTAG.stat == 'Unique DNTAG',]
ey <- nzm_original[nzm_original$UPTAG.stat == 'Unique UPTAG' | nzm_original$DNTAG.stat == 'Unique DNTAG',]
head(ey)
nzm_original$Comment
sum(nzm_original$Comment == 'Pick')
sum(nzm_original$UPTAG.stat == 'Unique UPTAG' | nzm_original$DNTAG.stat == 'Unique DNTAG')
s1 <- nzm_original$UPTAG.stat == 'Unique UPTAG' | nzm_original$DNTAG.stat == 'Unique DNTAG'
s2 <- nzm_original$Comment == 'Pick'
sum(s1 & !s2)
sum(s1)
sum(s2)
sum(s1 & !s1)
sum(s1 & !s2)
sum(s1 & s2)
sum(s2 & !s1)
nzm_original[s2 & !s1,]
nzm_original[s2 & !s1,'Plate']
nzm_original[s2 & !s1,'PLATE']
nzm_original[s2 & !s1,'Strain.Name']
ey2 <- nzm_original[s2 & !s1,'Strain.Name']
list.files()
getwd()
setwd('..')
ls
list.files()
read.table('twas_id_map_fixed.tsv')
t2 <- read.table('twas_id_map_fixed.tsv')
head(t2)
t2 <- read.table('twas_id_map_fixed.tsv',head=T,stringsAsFactors = F)
ey2 %in% t2$ID
nzm_original[s2 & !s1,'Plate']
sum(s1 & !s1)
sum(s2 & !s1)
nzm_original[s2 & !s1,'Plate']
nzm_original[s2 & !s1,]
subset <- nzm_original[s2 & !s1,]
library(dplyr)
filter(subset, UPTAG == 'GTTATTGTCGCAATGGCATTTGATC')
getwd()
twas_map <- read.table('twas_nov2014_t_5-20_pruned.tsv')
head(twas-map)
head(twas_map)
filter(subset, UPTAG == 'GTTATTGTCGCAATGGCATTTGATC')
sum(twas_map['TWAS21010111',])
twas_map['TWAS21010111',]
twas_map['TWAS21100114',]
dim(twas_Map)
dim(twas_map)
dim(t2)
subset <- nzm_original[s2 & !s1,]
subset
subset$PLATE
subset$Strain.Name
subset$Strain.Name %in% rownames(twas_map)
head(twas_map)
nzm_original$Strain.Name %in% rownames(twas_map)
sum(nzm_original$Strain.Name %in% rownames(twas_map))
dim(twaas_map)
dim(twas_map)
sum(nzm_original[s2,'Strain.Name'] %in% rownames(twas_map))
dim(nzm_original[s2,'Strain.Name'])
dim(nzm_original[s2,])
sum(s1)
7030 - 6895
sum(s1)
dim(nzm_original)
head(nzm_original)
nzm_original
sum(s1)
sum(s2)
s2 - s1
sum(s2) - sum(s1)
dim(subset)
subset
subset
filter(subset,UPTAG=='GTTATTGTCGCAATGGCATTTGATC')
filter(subset,UPTAG=='AGCTAAACGTCCAGTTGTTCGATGA')
sum(s)
sum(s1)
sum(s2)
filter(nzm_original,Strain.Name=='TWAS21251519')
ls()
head(twas_map)
twas_map['TWAS21251519',]
ls()
head(t2)
filter(t2,ID=='TWAS21251519')
head(nzm_original)
ncol(nzm_original)
ey <- ncol(nzm_original)
genocols <- ncol(nzm_original)
ey <- ncol(nzm_original[,(genocols-15):genocols])
ey
nzm_original[,(genocols-15):genocols]
head(nzm_original[,(genocols-15):genocols])
apply(nzm_original[,(genocols-15):genocols],1,sum)
nzm_original[apply(nzm_original[,(genocols-15):genocols],1,sum) == 0,]
which(apply(nzm_original[,(genocols-15):genocols],1,sum) == 0)
wts <- which(apply(nzm_original[,(genocols-15):genocols],1,sum) == 0)
nzm_original[wts,]
dim(nzm_original[wts,])
nzm_wts <- nzm_original[wts,]
grep('a0',nzm_wts$PLATE)
nzm_wts[grep('a0',nzm_wts$PLATE),]
nzm_wts[grep('a0',nzm_wts$PLATE,invert=T),]
nzm_wts[grep('alpha',nzm_wts$PLATE,invert=T),]
dim(nzm_wts[grep('alpha',nzm_wts$PLATE,invert=T),])
ey <- nzm_wts[grep('alpha',nzm_wts$PLATE,invert=T),]
ey
filter(ey, Comment == 'Pick')
dim(filter(ey, Comment == 'Pick'))
dim(nzm_wts[grep('alpha',nzm_wts$PLATE,invert=T),])
dim(nzm_wts[grep('alpha',nzm_wts$PLATE,invert=F),])
ey <- nzm_wts[grep('alpha',nzm_wts$PLATE,invert=T),]
dim(filter(ey, Comment == 'Pick'))
ey <- nzm_wts[grep('alpha',nzm_wts$PLATE,invert=F),]
dim(filter(ey, Comment == 'Pick'))
plated <- c('TWAS21161302',
'TWAS21160106',
'TWAS21160613',
'TWAS21161613',
'TWAS21160916',
'TWAS21161221',
'TWAS21160322',
'TWAS21160724',
'TWAS21161324',
'TWAS21170305',
'TWAS21170605',
'TWAS21170905',
'TWAS21170114',
'TWAS21170916',
'TWAS21170817',
'TWAS21170118',
'TWAS21170319',
'TWAS21170424',
'TWAS21181505',
'TWAS21181306',
'TWAS21181209',
'TWAS21181309',
'TWAS21181509',
'TWAS21180218',
'TWAS21190801',
'TWAS21190203',
'TWAS21190705',
'TWAS21190407',
'TWAS21190807',
'TWAS21190415',
'TWAS21191516',
'TWAS21200602',
'TWAS21201202',
'TWAS21201003',
'TWAS21200207',
'TWAS21200511',
'TWAS21201213',
'TWAS21200815',
'TWAS21200516',
'TWAS21200916',
'TWAS21201017',
'TWAS21210601',
'TWAS21210604',
'TWAS21210704',
'TWAS21211512',
'TWAS21210317',
'TWAS21211019',
'TWAS21211121',
'TWAS21211321',
'TWAS21210422',
'TWAS21210724',
'TWAS21221107',
'TWAS21220108',
'TWAS21220708',
'TWAS21221115',
'TWAS21220219',
'TWAS21221321',
'TWAS21230704',
'TWAS21230506',
'TWAS21230906',
'TWAS21230111',
'TWAS21230611',
'TWAS21231614',
'TWAS21231017',
'TWAS21231319',
'TWAS21230721',
'TWAS21241505',
'TWAS21240608',
'TWAS21241209',
'TWAS21241309',
'TWAS21240513',
'TWAS21240815',
'TWAS21240921',
'TWAS21250603',
'TWAS21251605',
'TWAS21251511',
'TWAS21251412',
'TWAS21250617',
'TWAS21250318',
'TWAS21251519',
'TWAS21251323',
'TWAS21251124',
'TWAS21260801',
'TWAS21261001',
'TWAS21261302',
'TWAS21260204',
'TWAS21260504',
'TWAS21261606',
'TWAS21260409',
'TWAS21260411',
'TWAS21260712',
'TWAS21260915',
'TWAS21260416',
'TWAS21260217',
'TWAS21261618',
'TWAS21270502',
'TWAS21270806',
'TWAS21270807',
'TWAS21270808',
'TWAS21270809',
'TWAS21270810',
'TWAS21270811',
'TWAS21270812',
'TWAS21270813',
'TWAS21270814',
'TWAS21270815',
'TWAS21270816',
'TWAS21270817',
'TWAS21270818',
'TWAS21270819',
'TWAS21270820',
'TWAS21270821',
'TWAS21270822',
'TWAS21270823',
'TWAS21270824',
'TWAS21270825',
'TWAS21270826',
'TWAS21270827',
'TWAS21270828',
'TWAS21270829',
'TWAS21270830',
'TWAS21270831',
'TWAS21270832',
'TWAS21270833',
'TWAS21270834',
'TWAS21270835',
'TWAS21270836',
'TWAS21270837',
'TWAS21270838',
'TWAS21270839',
'TWAS21270840')
ls()
head(nzm_original)
filter(nzm_original,Strain.Name %in% plated)
tail(filter(nzm_original,Strain.Name %in% plated))
filter(nzm_original,Strain.Name %in% plated)$Plate
filter(nzm_original,Strain.Name %in% plated)[,'PLATE']
length(filter(nzm_original,Strain.Name %in% plated)[,'PLATE'])
length(plated)
length(unique(plated))
dim(nzm_original)
length(unique(plated))
ls()
head(nzm_wts)
length(filter(nzm_original,Strain.Name %in% plated)[,'PLATE'])
length(filter(nzm_wts,Strain.Name %in% plated)[,'PLATE'])
filter(nzm_original,Strain.Name %in% plated)[,'PLATE']
filter(nzm_original,Strain.Name %in% plated)
max.print=1000000
filter(nzm_original,Strain.Name %in% plated)
options(max.print=1000000)
filter(nzm_original,Strain.Name %in% plated)
ls()
head(t2)
filter(t2, ID %in% plated)
length(plated)
plated
unique(plated)
nzm_original
dim(nzm_original)
head(nzm_original)
sum(nzm_original$Strain.Name %in% plated)
sum(!(nzm_original$Strain.Name %in% plated))
sum(!(plated %in% nzm_original$Strain.Name))
plated[!(plated %in% nzm_original$Strain.Name),]
plated[!(plated %in% nzm_original$Strain.Name)]
grep('TWAS21270825', nzm_original$Strain.Name)
grep('TWAS2127082', nzm_original$Strain.Name)
nzm_original[grep('TWAS2127082', nzm_original$Strain.Name),]
nzm_original[grep('TWAS2127083', nzm_original$Strain.Name),]
nzm_original[grep('TWAS2127082', nzm_original$Strain.Name),]
tail(nzm_original)
nzm_original[10176:10177,]
setwd('../../../twas/data/')
picked <- read.table('putative_wildtype_id_map_with_barcode.tsv')
picked <- read.table('putative_wildtype_id_map_with_barcode.tsv',sep='\t')
head(picked)
picked <- read.table('putative_wildtype_id_map_with_barcode.tsv',sep='\t',head=T)
sum(plated %iN% picked$Strain.Name)
sum(plated %in% picked$Strain.Name)
grep('alpha',picked$PDR10)
grep('alpha',picked$PLATE)
sum(grep('alpha',picked$PLATE))
length(grep('alpha',picked$PLATE))
dim(picked)
length(plated)
plated
length(grep('alpha',picked$PLATE)[,'Strain.Name'])
grep('alpha',picked$PLATE)[,'Strain.Name']
picked[grep('alpha',picked$PLATE),'Strain.Name']
as.vector(picked[grep('alpha',picked$PLATE),'Strain.Name'])
my_list <- as.vector(picked[grep('alpha',picked$PLATE),'Strain.Name'])
intersect(my_list,plated)
length(my_list)
length(plated)
intersect(my_list,plated)
'TWAS21270806' %in% plated
'TWAS21270806' %in% my_list
plated[!(plated %in% my_list)]
'TWAS21270807' %in% my_list
my_list
head(picked)
dim(picked)
head(picked)
length(grep('alpha',picked$PLATE))
length(grep('alpha',picked$PLATE,invert=T))
head(nzm_wts)
dim(nzm_wts)
nzm_wts
plated
length(plated)
length(plated %in% picked$Strain.Name)
sum(plated %in% picked$Strain.Name)
97 - 23
head(picked)
dim(picked)
dim(nzm_picked)
ls()
dim(nzm_wts)
131+73
nzm_wts
rnorm(10) != rnorm(10)
source('~/Dropbox/Roth Lab/projects/bc_pca_git/scripts/master.R', echo=TRUE)
levy_filename <- '../data/levy_2014_ab.tsv'
levy_data <- read.table(levy_filename,sep='\t',head=T)
localization_dist <- log2(levy_data$AB.MEM.AGENT/levy_data$AB.CYTO.AGENT)
localization_dist <- localization_dist[!is.na(localization_dist)]
expression_dist <- -log2(levy_data$AB.GFP.YMD/levy_data$AB.GFP.YPD)
expression_dist <- expression_dist[!is.na(expression_dist)]
predictions <- pca_ma_prediction(pca_universe,
protein_abundance_file,
expression_file,
'ethanol',
prediction_method = "independent",
shuffled_kds = F)
density_output_path <- paste(c(output_path,'levy_comparison'),collapse='/')
dir.create(density_output_path, showWarnings = FALSE)
outfile <- paste(c(density_output_path,'effect_size_dist.pdf'),collapse='/')
CairoPDF(file=outfile,width=8.5,height=6)
d1 <- density(predictions$bcPCA_FC.AVG,adj=1.5,from=-6,to=6)
plot(d1,type='n',main='',xlab='Effect Size [Log2(R)]',cex.lab=1.5)
polygon(d1,col=rgb(0,0,0.5,0.3),border=NA)#
lines(d1,lwd=4,col=rgb(0,0,0.5,0.8))
d2 <- density(localization_dist,adj=1.5,from=-6,to=6)
polygon(d2,col=rgb(0.5,0,0,0.3),border=NA)
lines(d2,lwd=4,col=rgb(0.5,0,0,0.8))
d3 <- density(expression_dist,adj=1.5,from=-6,to=6)
polygon(d3,col=rgb(0,0.5,0,0.3),border=NA)
lines(d3,lwd=4,col=rgb(0,0.5,0,0.8))
d4 <- density(predictions$Log2_MA_prediction,adj=1.5,from=-6,to=6)
polygon(d4,col=rgb(0.5,0.7,1,0.3),border=NA)
lines(d4,lwd=4,col=rgb(0.5,0.7,1,0.8))
legend('topleft',legend=c('Membrane vs Cytosol','YPD vs minimal','Ethanol BC-PCA (Observed)','Ethanol BC-PCA (mRNA Predicted)'),fill=c('darkred','darkgreen','darkblue',rgb(0.5,0.7,1)))
dev.off()
marks <- c(94,85,100,74,96,58,98,94,96,92,73,88)
mean(marks)
hist(marks)
hist(marks,breaks=10)
hist(marks,breaks=12)
hist(marks,breaks=15)
hist(marks)
marks <- c(94,85,100,74,96,58,98,94,96,92,83,88)
mean(marks)
hist(marks)
marks <- c(94,85,100,74,86,38,98,94,96,92,73,68)
mean(marks)
hist(marks)
hist(marks,xlab='marks with late penalty',main='Histogram of marks with late penalty')
